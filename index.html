<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>League Builder</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brandIcon">L</div>
      <div class="brandText">
        <div class="brandTitle">League Builder</div>
        <div class="brandSub" id="crumb">ホーム</div>
      </div>
    </div>

    <div class="topActions" id="topActions">
      <button class="chipBtn" id="btnHomeTop">ホーム</button>
      <button class="chipBtn" id="btnSeasonPicker" style="display:none;">
        シーズン切替 ▾
      </button>
    </div>
  </header>

  <!-- Season switch dropdown (collapsible) -->
  <div class="dropdown" id="seasonDropdown" style="display:none;">
    <div class="dropdownInner">
      <div class="dropdownTitle">シーズン</div>
      <div class="dropdownList" id="seasonListTop"></div>
    </div>
  </div>

  <main class="wrap">
    <!-- HOME -->
    <section class="panel" id="viewHome">
      <div class="panelHead">
        <div class="panelTitle">リーグ</div>
        <div class="panelMeta">リーグを作成して管理します</div>
      </div>

      <div class="tools">
        <button class="btnPrimary" id="btnAddLeague">リーグ追加</button>
      </div>

      <div class="grid2" id="leagueGrid"></div>
    </section>

    <!-- LEAGUE MANAGER -->
    <section class="panel" id="viewLeague" style="display:none;">
      <div class="panelHead">
        <div>
          <div class="panelTitle" id="leagueTitle">リーグ</div>
          <div class="panelMeta" id="leagueMeta">リーグ設定 / チーム / シーズン</div>
        </div>
        <div class="headRight">
          <button class="chipBtn" id="btnBackHome">戻る</button>
        </div>
      </div>

      <div class="subPanel">
        <div class="subHead">
          <div class="subTitle">リーグ設定</div>
        </div>
        <div class="row">
          <div class="field">
            <label>リーグ名</label>
            <input id="leagueName" placeholder="League1" />
          </div>
          <div class="field">
            <label>ロゴ</label>
            <div class="logoPick">
              <div class="sqLogo" id="leagueLogoPreview">L</div>
              <input type="file" accept="image/*" id="leagueLogoFile" />
            </div>
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <button class="btnPrimary" id="btnSaveLeague">保存</button>
          </div>
        </div>
      </div>

      <div class="cols">
        <div class="col">
          <div class="subPanel">
            <div class="subHead">
              <div class="subTitle">チーム</div>
              <button class="btnGhost" id="btnAddTeam">チーム追加</button>
            </div>
            <div class="grid2 scrollBox" id="teamGrid"></div>
          </div>
        </div>

        <div class="col">
          <div class="subPanel">
            <div class="subHead">
              <div class="subTitle">シーズン</div>
              <button class="btnGhost" id="btnAddSeason">シーズン追加</button>
            </div>
            <div class="scrollBox" id="seasonList"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- SEASON -->
    <section class="panel" id="viewSeason" style="display:none;">
      <div class="panelHead">
        <div>
          <div class="panelTitle" id="seasonTitle">Season</div>
          <div class="panelMeta" id="seasonMeta">ディビジョンを作成して管理します</div>
        </div>
        <div class="headRight">
          <button class="chipBtn" id="btnBackLeague">リーグへ</button>
        </div>
      </div>

      <div class="subPanel compact">
        <div class="subHead">
          <div class="subTitle">シーズン設定</div>
        </div>
        <div class="row">
          <div class="field">
            <label>シーズン名</label>
            <input id="seasonName" placeholder="Season 1" />
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <button class="btnPrimary" id="btnSaveSeason">保存</button>
          </div>
          <div class="field">
            <label>&nbsp;</label>
            <button class="btnDanger" id="btnDeleteSeason">削除</button>
          </div>
        </div>
      </div>

      <div class="subPanel">
        <div class="subHead">
          <div class="subTitle">ディビジョン</div>
          <button class="btnGhost" id="btnAddDivision">ディビジョン追加</button>
        </div>

        <div class="divisionListWrap">
          <div class="divisionButtons" id="divisionButtons"></div>
        </div>

        <div class="divider"></div>

        <div class="divisionEditor" id="divisionEditor" style="display:none;">
          <div class="subHead">
            <div class="subTitle" id="divisionTitle">Division</div>
            <div class="rightRow">
              <button class="btnGhost" id="btnToggleDivEdit">編集 ▾</button>
              <button class="btnDanger" id="btnDeleteDivision">削除</button>
            </div>
          </div>

          <div class="collapse" id="divEditCollapse" style="display:none;">
            <div class="row">
              <div class="field">
                <label>ディビジョン名</label>
                <input id="divisionName" placeholder="Division1" />
              </div>
              <div class="field">
                <label>ロゴ</label>
                <div class="logoPick">
                  <div class="sqLogo" id="divisionLogoPreview">D</div>
                  <input type="file" accept="image/*" id="divisionLogoFile" />
                </div>
              </div>
              <div class="field">
                <label>&nbsp;</label>
                <button type="button" class="btnPrimary" id="btnSaveDivision">保存</button>
              </div>
            </div>

            <div class="subHead thin">
              <div class="subTitle">参加チーム</div>
              <div class="subMeta">リーグに登録済みのチームから選択</div>
            </div>
            <div class="scrollBox teamPick" id="divisionTeamPick"></div>

            <div class="divider"></div>

            <div class="subHead thin">
              <div class="subTitle">順位カラー（凡例）</div>
              <div class="subMeta">順位表の左側に表示する細いライン</div>
            </div>
            <div class="helpText">順位範囲ごとに色と名前を設定できます（例: 1〜1=優勝 / 8〜8=入れ替え戦）。</div>
            <div class="row" style="align-items:flex-end;">
              <div class="field" style="min-width:180px;">
                <label>&nbsp;</label>
                <button type="button" class="btnGhost" id="btnAddRankBand">凡例を追加</button>
              </div>
            </div>
            <div id="rankBandList" class="rankBandList"></div>
          </div>

          <div class="divNav">
            <button class="tabBtn active" data-tab="schedule">日程/結果</button>
            <button class="tabBtn" data-tab="standings">順位表</button>
            <button class="tabBtn" data-tab="teams">チーム一覧</button>
          </div>

          <div class="divTab" id="tabSchedule">
            <div class="tools">
              <button class="btnPrimary" id="btnGenSchedule">日程を作成</button>
              <select id="selRounds" class="select">
                <option value="1">1回総当たり</option>
                <option value="2">2回総当たり</option>
                <option value="3">3回総当たり</option>
                <option value="4">4回総当たり</option>
              </select>
              <button class="btnDanger" id="btnResetSchedule">日程リセット</button>
            </div>

            <div class="matchdayRow">
              <div class="matchdayLabel">節</div>
              <div class="matchdayButtons" id="matchdayButtons"></div>
            </div>

            <div class="matchList" id="matchList"></div>

            <div class="divider"></div>

            <div class="subHead thin">
              <div class="subTitle">任意の試合（リーグ全体）</div>
              <div class="subMeta">ディビジョン外</div>
            </div>

            <div class="freeForm">
              <div class="field">
                <label>試合名</label>
                <input id="freeName" placeholder="例：Super Cup / Friendly など" />
              </div>
              <div class="field">
                <label>ホーム</label>
                <select id="freeHome"></select>
              </div>
              <div class="field">
                <label>アウェイ</label>
                <select id="freeAway"></select>
              </div>
              <button id="btnAddFree" class="btnPrimary">追加</button>
            </div>

            <div class="matchList compact" id="freeList"></div>
          </div>

          <div class="divTab" id="tabStandings" style="display:none;">
            <div class="standingsWrap">
              <div class="standingsHeader">
                <div>
                  <div class="sectionTitle">リーグ順位表</div>
                  <div class="sub">試合結果から自動計算（勝ち点→得失点差→得点）</div>
                </div>
                <button class="btn" id="btnSaveRankSnapshot" type="button">現在順位を保存</button>
              </div>

              <table class="standingsTable">
                <thead>
                  <tr>
                    <th class="col-rank">順位</th>
                    <th class="col-team">チーム</th>
                    <th class="col-num">試合</th>
                    <th class="col-num">勝</th>
                    <th class="col-num">分</th>
                    <th class="col-num">負</th>
                    <th class="col-num">得点</th>
                    <th class="col-num">失点</th>
                    <th class="col-num">差</th>
                    <th class="col-num">勝ち点</th>
                    <th class="col-form">調子</th>
                  </tr>
                </thead>
                <tbody id="standingsTbody"></tbody>
              </table>

              <div class="legendRow" id="standingsLegend"></div>
            </div>
          </div>

          <div class="divTab" id="tabTeams" style="display:none;">
            <div class="emptyNote">チーム一覧は次で実装します</div>
          </div>
        </div>
      </div>
    </section>

    <!-- メモ欄は削除（画面を広く使う） -->
  </main>

  <script src="app.js"></script>
</body>
</html>
